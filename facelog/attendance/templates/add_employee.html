<form method="POST" enctype="multipart/form-data" id="employeeForm">
    {% csrf_token %}

    <label>Employee Name:</label>
    <input type="text" id="emp_name" name="emp_name" required>

    <label>Capture Profile Image (Optional):</label>
    <video id="video" width="320" height="240" autoplay></video>
    <button type="button" id="captureBtn">Capture</button>
    <canvas id="canvas" style="display: none;"></canvas>
    <img id="capturedImage" style="display:none;" />
    <input type="hidden" name="captured_image" id="captured_image">

    <label>Upload Additional Images (Optional):</label>
    <input type="file" name="uploaded_images" id="uploaded_images" multiple>

    <button type="submit">Save Employee</button>
</form>

<script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const capturedImage = document.getElementById('capturedImage');
    const captureBtn = document.getElementById('captureBtn');
    const hiddenInput = document.getElementById('captured_image');

    // Start webcam
    navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
        video.srcObject = stream;
    });

    captureBtn.addEventListener('click', () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);

        // Convert to base64
        let imageData = canvas.toDataURL('image/png');
        capturedImage.src = imageData;
        capturedImage.style.display = 'block';

        // Save base64 data to input field
        hiddenInput.value = imageData;
    });
</script>